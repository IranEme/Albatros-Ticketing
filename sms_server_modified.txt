const express = require('express');
const { exec } = require('child_process');
const cors = require('cors');
const app = express();

app.use(express.json());
app.use(cors());

app.post('/enviar-sms', (req, res) => {
    const { mensaje } = req.body; // Ya no necesitamos 'numero' del body

    // El nÃºmero de destino ahora estÃ¡ fijo
    const numeroDestinoFijo = '6462862491'; 

    if (!mensaje) {
        return res.status(400).json({ error: 'Falta el mensaje' });
    }

    console.log(`Intentando enviar a ${numeroDestinoFijo}: ${mensaje}`);

    // Comando nativo de Termux para enviar SMS, usando el nÃºmero fijo
    exec(`termux-sms-send -n ${numeroDestinoFijo} "${mensaje}"`, (error, stdout, stderr) => {
        if (error) {
            console.error(`Error: ${error.message}`);
            return res.status(500).json({ error: 'Fallo al enviar' });
        }
        console.log('Â¡SMS Enviado!');
        res.json({ status: 'Exito', info: 'Mensaje enviado' });
    });
});

app.listen(3000, () => console.log('ğŸ¤– Servidor Android listo en puerto 3000'));
